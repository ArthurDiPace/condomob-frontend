{"ast":null,"code":"import moment from 'moment';\nimport SPagebar from '@/layout/SPagebar.vue';\nimport * as SemobService from '@/services/semob.service';\nimport PromptDialog from '@/components/PromptDialog.vue';\nexport default {\n  name: 'BoletoConsulta',\n  components: {\n    SPagebar,\n    PromptDialog\n  },\n  data: () => ({\n    carregando: false,\n    breadcrumbs: [{\n      'text': 'Consultar boleto',\n      'disabled': true\n    }],\n    boleto: {\n      nosso_numero: ''\n    },\n    errors: {}\n  }),\n  methods: {\n    async consultarBoleto() {\n      this.carregando = true;\n      try {\n        const response = await SemobService.buscarBoleto(this.boleto.nosso_numero);\n        const boleto = {\n          valor: response.data.valorPagoSacado,\n          data_pagamento: response.data.dataRecebimentoTitulo ? moment(response.data.dataRecebimentoTitulo, \"DDMMYYYY\").format('DD/MM/YYYY') : null\n        };\n        if (response.data.codigoTipoLiquidacao === 4) {\n          // Verifica se o tipo de liquidação é PIX\n          if (response.data.valorPagoSacado >= response.data.valorAtualTituloCobranca) {\n            this.carregando = false;\n            this.showSuccessToast(`Boleto pago no PIX no valor de: ${boleto.valor}, Data de Pagamento: ${boleto.data_pagamento}`);\n            return boleto;\n          }\n        } else {\n          // Se não for PIX\n          if (response.data.valorPagoSacado >= response.data.valorAtualTituloCobranca) {\n            const dataAtual = moment(); // Obtém a data atual\n            const dataPagamento = moment(response.data.dataRecebimentoTitulo, \"DDMMYYYY\"); // Obtém a data de pagamento do boleto\n\n            if (dataAtual.diff(dataPagamento, 'hours') < 24) {\n              // Verifica se passou menos de 24 horas desde o pagamento\n              this.carregando = false;\n              this.showErrorToast(\"Espere mais do que 24 horas para consultar o boleto\");\n              return null;\n            } else {\n              // Se passou mais de 24 horas desde o pagamento\n              this.carregando = false;\n              this.showSuccessToast(`Valor Pago: ${boleto.valor}, Data de Pagamento: ${boleto.data_pagamento}`);\n              return boleto;\n            }\n          } else {\n            // Se o boleto ainda não foi pago\n            this.carregando = false;\n            this.showErrorToast(\"Boleto ainda não foi pago\");\n            return null;\n          }\n        }\n      } catch (error) {\n        this.carregando = false;\n        if (error.response) {\n          const statusCode = error.response.status;\n          switch (statusCode) {\n            case 500:\n              this.showErrorToast(\"Erro do servidor. Por favor, tente novamente mais tarde.\");\n              break;\n            case 400:\n              this.showErrorToast(\"Esse Boleto não existe.\");\n              break;\n            default:\n              this.handleError(error);\n          }\n        } else {\n          this.handleError(error);\n        }\n      }\n    },\n    showSuccessToast(message) {\n      this.$toast.open({\n        message: message,\n        type: 'success'\n      });\n    },\n    showErrorToast(message) {\n      this.$toast.open({\n        message: message,\n        type: 'error'\n      });\n    },\n    handleError(error) {\n      this.errors = error;\n    }\n  }\n};","map":{"version":3,"names":["moment","SPagebar","SemobService","PromptDialog","name","components","data","carregando","breadcrumbs","boleto","nosso_numero","errors","methods","consultarBoleto","response","buscarBoleto","valor","valorPagoSacado","data_pagamento","dataRecebimentoTitulo","format","codigoTipoLiquidacao","valorAtualTituloCobranca","showSuccessToast","dataAtual","dataPagamento","diff","showErrorToast","error","statusCode","status","handleError","message","$toast","open","type"],"sources":["src/views/consulta/ConsultaBoleto.vue"],"sourcesContent":["<template>\n  <v-container fluid>\n    <s-pagebar\n      page-title=\"Consultar boleto\"\n      :breadcrumbs=\"breadcrumbs\"\n    />\n    <v-card flat>\n      <v-card-text>\n        <v-row dense>\n          <v-col\n            cols=\"12\"\n            md=\"3\"\n            sm=\"12\"\n          >\n            <v-text-field\n              v-model=\"boleto.nosso_numero\"\n              v-mask=\"['XXXXXXXXXXXXXXXXXXXX']\"\n              label=\"Nosso Numero\"\n              class=\"required\"\n              :error-messages=\"errors.nosso_numero\"\n              :loading=\"carregando\"\n            />\n          </v-col>\n        </v-row>\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer />\n        <v-btn\n          outlined\n          color=\"primary\"\n          @click=\"consultarBoleto\"\n        >\n          Consultar\n        </v-btn>\n        <v-btn\n          outlined\n          color=\"blue-grey darken-4\"\n          @click=\"$router.back()\"\n        >\n          Voltar\n        </v-btn>\n      </v-card-actions>\n      <prompt-dialog ref=\"prompt\" />\n    </v-card>\n  </v-container>\n</template>\n\n<script>\nimport moment from 'moment'\nimport SPagebar from '@/layout/SPagebar.vue'\nimport * as SemobService from '@/services/semob.service'\nimport PromptDialog from '@/components/PromptDialog.vue'\n\nexport default {\n  name: 'BoletoConsulta',\n  components: { SPagebar, PromptDialog },\n  data: () => ({\n    carregando: false,\n    breadcrumbs: [\n      {\n        'text': 'Consultar boleto',\n        'disabled': true\n      }\n    ],\n    boleto: {\n      nosso_numero: '',\n    },\n    errors: {},\n  }),\n  methods: {\n    async consultarBoleto() {\n      this.carregando = true;\n      try {\n        const response = await SemobService.buscarBoleto(this.boleto.nosso_numero);\n        const boleto = {\n          valor: response.data.valorPagoSacado,\n          data_pagamento: response.data.dataRecebimentoTitulo ? moment(response.data.dataRecebimentoTitulo, \"DDMMYYYY\").format('DD/MM/YYYY') : null,\n        };\n\n        if (response.data.codigoTipoLiquidacao === 4) { // Verifica se o tipo de liquidação é PIX\n          if (response.data.valorPagoSacado >= response.data.valorAtualTituloCobranca) {\n            this.carregando = false;\n            this.showSuccessToast(`Boleto pago no PIX no valor de: ${boleto.valor}, Data de Pagamento: ${boleto.data_pagamento}`);\n            return boleto;\n          }\n        } else { // Se não for PIX\n          if (response.data.valorPagoSacado >= response.data.valorAtualTituloCobranca) {\n            const dataAtual = moment(); // Obtém a data atual\n            const dataPagamento = moment(response.data.dataRecebimentoTitulo, \"DDMMYYYY\"); // Obtém a data de pagamento do boleto\n\n            if (dataAtual.diff(dataPagamento, 'hours') < 24) { // Verifica se passou menos de 24 horas desde o pagamento\n              this.carregando = false;\n              this.showErrorToast(\"Espere mais do que 24 horas para consultar o boleto\");\n              return null;\n            } else { // Se passou mais de 24 horas desde o pagamento\n              this.carregando = false;\n              this.showSuccessToast(`Valor Pago: ${boleto.valor}, Data de Pagamento: ${boleto.data_pagamento}`);\n              return boleto;\n            }\n          } else { // Se o boleto ainda não foi pago\n            this.carregando = false;\n            this.showErrorToast(\"Boleto ainda não foi pago\");\n            return null;\n          }\n        }\n      } catch (error) {\n        this.carregando = false;\n        \n        if (error.response) {\n          const statusCode = error.response.status;\n\n          switch (statusCode) {\n            case 500:\n              this.showErrorToast(\"Erro do servidor. Por favor, tente novamente mais tarde.\");\n              break;\n            case 400:\n              this.showErrorToast(\"Esse Boleto não existe.\");\n              break;\n            default:\n              this.handleError(error);\n          }\n        } else {\n          this.handleError(error);\n        }\n      }\n    },\n    showSuccessToast(message) {\n      this.$toast.open({\n        message: message,\n        type: 'success',\n      })\n    },\n    showErrorToast(message) {\n      this.$toast.open({\n        message: message,\n        type: 'error',\n      });\n    },\n    handleError(error) {\n      this.errors = error\n    },\n  }\n}\n</script>\n\n<style>\n.required label::after {\n    content: \"*\";\n    color: red;\n}\n</style>"],"mappings":"AAgDA,OAAAA,MAAA;AACA,OAAAC,QAAA;AACA,YAAAC,YAAA;AACA,OAAAC,YAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IAAAJ,QAAA;IAAAE;EAAA;EACAG,IAAA,EAAAA,CAAA;IACAC,UAAA;IACAC,WAAA,GACA;MACA;MACA;IACA,EACA;IACAC,MAAA;MACAC,YAAA;IACA;IACAC,MAAA;EACA;EACAC,OAAA;IACA,MAAAC,gBAAA;MACA,KAAAN,UAAA;MACA;QACA,MAAAO,QAAA,SAAAZ,YAAA,CAAAa,YAAA,MAAAN,MAAA,CAAAC,YAAA;QACA,MAAAD,MAAA;UACAO,KAAA,EAAAF,QAAA,CAAAR,IAAA,CAAAW,eAAA;UACAC,cAAA,EAAAJ,QAAA,CAAAR,IAAA,CAAAa,qBAAA,GAAAnB,MAAA,CAAAc,QAAA,CAAAR,IAAA,CAAAa,qBAAA,cAAAC,MAAA;QACA;QAEA,IAAAN,QAAA,CAAAR,IAAA,CAAAe,oBAAA;UAAA;UACA,IAAAP,QAAA,CAAAR,IAAA,CAAAW,eAAA,IAAAH,QAAA,CAAAR,IAAA,CAAAgB,wBAAA;YACA,KAAAf,UAAA;YACA,KAAAgB,gBAAA,oCAAAd,MAAA,CAAAO,KAAA,wBAAAP,MAAA,CAAAS,cAAA;YACA,OAAAT,MAAA;UACA;QACA;UAAA;UACA,IAAAK,QAAA,CAAAR,IAAA,CAAAW,eAAA,IAAAH,QAAA,CAAAR,IAAA,CAAAgB,wBAAA;YACA,MAAAE,SAAA,GAAAxB,MAAA;YACA,MAAAyB,aAAA,GAAAzB,MAAA,CAAAc,QAAA,CAAAR,IAAA,CAAAa,qBAAA;;YAEA,IAAAK,SAAA,CAAAE,IAAA,CAAAD,aAAA;cAAA;cACA,KAAAlB,UAAA;cACA,KAAAoB,cAAA;cACA;YACA;cAAA;cACA,KAAApB,UAAA;cACA,KAAAgB,gBAAA,gBAAAd,MAAA,CAAAO,KAAA,wBAAAP,MAAA,CAAAS,cAAA;cACA,OAAAT,MAAA;YACA;UACA;YAAA;YACA,KAAAF,UAAA;YACA,KAAAoB,cAAA;YACA;UACA;QACA;MACA,SAAAC,KAAA;QACA,KAAArB,UAAA;QAEA,IAAAqB,KAAA,CAAAd,QAAA;UACA,MAAAe,UAAA,GAAAD,KAAA,CAAAd,QAAA,CAAAgB,MAAA;UAEA,QAAAD,UAAA;YACA;cACA,KAAAF,cAAA;cACA;YACA;cACA,KAAAA,cAAA;cACA;YACA;cACA,KAAAI,WAAA,CAAAH,KAAA;UACA;QACA;UACA,KAAAG,WAAA,CAAAH,KAAA;QACA;MACA;IACA;IACAL,iBAAAS,OAAA;MACA,KAAAC,MAAA,CAAAC,IAAA;QACAF,OAAA,EAAAA,OAAA;QACAG,IAAA;MACA;IACA;IACAR,eAAAK,OAAA;MACA,KAAAC,MAAA,CAAAC,IAAA;QACAF,OAAA,EAAAA,OAAA;QACAG,IAAA;MACA;IACA;IACAJ,YAAAH,KAAA;MACA,KAAAjB,MAAA,GAAAiB,KAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}