{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport PromptDialog from '@/components/PromptDialog.vue';\nexport default {\n  name: \"PessoaList\",\n  components: {\n    PromptDialog\n  },\n  props: {\n    permissao: Object,\n    disabledButtons: Boolean\n  },\n  data: () => ({\n    headers: [{\n      text: \"CPF/CNPJ\",\n      value: \"numero_documento\"\n    }, {\n      text: \"Nome\",\n      value: \"nome\"\n    }, {\n      text: \"Função\",\n      value: \"funcao\"\n    }, {\n      text: \"Data Cadastro\",\n      value: \"data_cadastro\"\n    }, {\n      text: \"Pré-cadastro\",\n      value: \"pre_cadastro\"\n    }, {\n      text: \"Ações\",\n      value: \"action\"\n    }],\n    totalItems: 0,\n    items: [],\n    options: {}\n  }),\n  watch: {\n    options: {\n      handler() {\n        this.getPessoas();\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async getPessoas() {\n      const {\n        sortBy,\n        sortDesc,\n        page,\n        itemsPerPage\n      } = this.options;\n      const query = {\n        permissao: this.permissao.id,\n        page: page,\n        page_size: itemsPerPage,\n        ordering: `${sortDesc && sortDesc[0] ? \"-\" : \"\"}${sortBy}`\n      };\n      const response = await this.$api.list({\n        resource: this.$endpoints.PESSOA,\n        query: query\n      });\n      this.items = response.data.results;\n      this.totalItems = response.data.count;\n    },\n    editarPessoa(item) {\n      if (item.pre_cadastro) {\n        this.$router.push(`/pessoa/precadastro/${item.id}`);\n      } else {\n        this.$router.push(`/pessoa/${item.id}`);\n      }\n    },\n    async deletarPessoa(pessoaId) {\n      const res = await this.$refs.prompt.open('Requerimento', 'Informe o número do requerimento', 'Número do requerimento');\n      if (res) {\n        const response = this.$api.destroy({\n          resource: this.$endpoints.PESSOA,\n          id: pessoaId,\n          data: {\n            numero_requerimento: res\n          }\n        });\n        response.then(() => this.getPessoas()).catch(err => {\n          this.$toast.open({\n            message: err,\n            type: \"error\"\n          });\n        });\n      }\n    },\n    cancelarOficios(numeroDocumento) {\n      const response = this.$api.create({\n        resource: this.$endpoints.CANCELAR_OFICIOS,\n        data: {\n          numero_documento: numeroDocumento\n        }\n      });\n      response.then(() => {\n        this.$toast.open({\n          message: 'Ofícios cancelados com sucesso',\n          type: 'success'\n        });\n      }).catch(error => {\n        this.errors = this.handleError(error);\n      });\n    }\n  }\n};","map":{"version":3,"names":["PromptDialog","name","components","props","permissao","Object","disabledButtons","Boolean","data","headers","text","value","totalItems","items","options","watch","handler","getPessoas","deep","methods","sortBy","sortDesc","page","itemsPerPage","query","id","page_size","ordering","response","$api","list","resource","$endpoints","PESSOA","results","count","editarPessoa","item","pre_cadastro","$router","push","deletarPessoa","pessoaId","res","$refs","prompt","open","destroy","numero_requerimento","then","catch","err","$toast","message","type","cancelarOficios","numeroDocumento","create","CANCELAR_OFICIOS","numero_documento","error","errors","handleError"],"sources":["src/views/pessoa/PessoaList.vue"],"sourcesContent":["<template>\n  <div>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"items\"\n      :options.sync=\"options\"\n      :server-items-length=\"totalItems\"\n      :items-per-page=\"10\"\n      :footer-props=\"{\n        'items-per-page-options': [10, 20, 30]\n      }\"\n    >\n      <template #[`item.pre_cadastro`]=\"{ item }\">\n        <v-chip\n          v-if=\"item.pre_cadastro\"\n          color=\"red darken-2\"\n          dark\n        >\n          Pré-cadastro\n        </v-chip>\n        <v-chip\n          v-else\n          color=\"green darken-2\"\n          dark\n        >\n          Cadastro\n        </v-chip>\n      </template>\n      <template #[`item.action`]=\"{ item }\">\n        <v-toolbar-items>\n          <v-tooltip bottom>\n            <template #activator=\"{ on, attrs }\">\n              <v-btn\n                v-bind=\"attrs\"\n                icon\n                :disabled=\"disabledButtons\"\n                v-on=\"on\"\n                @click=\"cancelarOficios(item.numero_documento)\"            \n              >\n                <v-icon class=\"material-icons-outlined\">\n                  cancel_presentation\n                </v-icon>\n              </v-btn>\n            </template>\n            <span>Cancelar Oficio</span>\n          </v-tooltip>\n          <v-tooltip bottom>\n            <template #activator=\"{ on, attrs }\">\n              <v-btn\n                v-bind=\"attrs\"\n                icon\n                :disabled=\"disabledButtons\"\n                v-on=\"on\"\n                @click=\"editarPessoa(item)\"\n              >\n                <v-icon class=\"material-icons-outlined\">\n                  visibility\n                </v-icon>\n              </v-btn>\n            </template>\n            <span>Editar</span>\n          </v-tooltip>\n          <v-tooltip bottom>\n            <template #activator=\"{ on, attrs }\">\n              <v-btn\n                v-bind=\"attrs\"\n                icon\n                :disabled=\"disabledButtons\"\n                v-on=\"on\"\n                @click=\"deletarPessoa(item.id)\"\n              >\n                <v-icon class=\"material-icons-outlined\">\n                  delete\n                </v-icon>\n              </v-btn>\n            </template>\n            <span>Deletar</span>\n          </v-tooltip>\n        </v-toolbar-items>\n      </template>\n    </v-data-table>\n    <PromptDialog ref=\"prompt\" />\n  </div>\n</template>\n\n<script>\nimport PromptDialog from '@/components/PromptDialog.vue'\n\nexport default {\n    name: \"PessoaList\",\n    components: {\n      PromptDialog\n    },\n    props: {\n        permissao: Object,\n        disabledButtons: Boolean\n    },\n    data: () => ({\n        headers: [\n            { text: \"CPF/CNPJ\", value: \"numero_documento\" },\n            { text: \"Nome\", value: \"nome\" },\n            { text: \"Função\", value: \"funcao\" },\n            { text: \"Data Cadastro\", value: \"data_cadastro\" },\n            { text: \"Pré-cadastro\", value: \"pre_cadastro\" },\n            { text: \"Ações\", value: \"action\" },\n        ],\n        totalItems: 0,\n        items: [],\n        options: {},\n    }),\n    watch: {\n        options: {\n            handler() {\n                this.getPessoas();\n            },\n            deep: true\n        },\n    },\n    methods: {\n        async getPessoas() {\n          const { sortBy, sortDesc, page, itemsPerPage } = this.options;\n          const query = {\n              permissao: this.permissao.id,\n              page: page,\n              page_size: itemsPerPage,\n              ordering: `${sortDesc && sortDesc[0] ? \"-\" : \"\"}${sortBy}`\n          };\n          const response = await this.$api.list({\n              resource: this.$endpoints.PESSOA,\n              query: query\n          });\n          this.items = response.data.results;\n          this.totalItems = response.data.count;\n        },\n        editarPessoa(item) {\n          if(item.pre_cadastro) {\n            this.$router.push(`/pessoa/precadastro/${item.id}`)\n          } else {\n            this.$router.push(`/pessoa/${item.id}`)\n          }\n        },\n        async deletarPessoa(pessoaId) {\n            const res = await this.$refs.prompt.open(\n              'Requerimento',\n              'Informe o número do requerimento',\n              'Número do requerimento'\n            )\n            if (res) {\n            const response = this.$api.destroy({\n                resource: this.$endpoints.PESSOA,\n                id: pessoaId,\n                data: {\n                  numero_requerimento: res\n                }\n            });\n            response\n                .then(() => this.getPessoas())\n                .catch(err => {\n                this.$toast.open({\n                    message: err,\n                    type: \"error\",\n                });\n            });\n          }\n        },\n        cancelarOficios(numeroDocumento) {\n          const response = this.$api.create({\n            resource: this.$endpoints.CANCELAR_OFICIOS,\n            data: {\n              numero_documento: numeroDocumento\n            }\n          })\n          response\n            .then(()=>{\n              this.$toast.open({\n                  message: 'Ofícios cancelados com sucesso',\n                  type: 'success',\n              })\n            })\n            .catch(error=>{\n              this.errors = this.handleError(error)\n            })\n        },\n      },\n}\n</script>"],"mappings":";AAsFA,OAAAA,YAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IACAF;EACA;EACAG,KAAA;IACAC,SAAA,EAAAC,MAAA;IACAC,eAAA,EAAAC;EACA;EACAC,IAAA,EAAAA,CAAA;IACAC,OAAA,GACA;MAAAC,IAAA;MAAAC,KAAA;IAAA,GACA;MAAAD,IAAA;MAAAC,KAAA;IAAA,GACA;MAAAD,IAAA;MAAAC,KAAA;IAAA,GACA;MAAAD,IAAA;MAAAC,KAAA;IAAA,GACA;MAAAD,IAAA;MAAAC,KAAA;IAAA,GACA;MAAAD,IAAA;MAAAC,KAAA;IAAA,EACA;IACAC,UAAA;IACAC,KAAA;IACAC,OAAA;EACA;EACAC,KAAA;IACAD,OAAA;MACAE,QAAA;QACA,KAAAC,UAAA;MACA;MACAC,IAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAF,WAAA;MACA;QAAAG,MAAA;QAAAC,QAAA;QAAAC,IAAA;QAAAC;MAAA,SAAAT,OAAA;MACA,MAAAU,KAAA;QACApB,SAAA,OAAAA,SAAA,CAAAqB,EAAA;QACAH,IAAA,EAAAA,IAAA;QACAI,SAAA,EAAAH,YAAA;QACAI,QAAA,KAAAN,QAAA,IAAAA,QAAA,iBAAAD,MAAA;MACA;MACA,MAAAQ,QAAA,cAAAC,IAAA,CAAAC,IAAA;QACAC,QAAA,OAAAC,UAAA,CAAAC,MAAA;QACAT,KAAA,EAAAA;MACA;MACA,KAAAX,KAAA,GAAAe,QAAA,CAAApB,IAAA,CAAA0B,OAAA;MACA,KAAAtB,UAAA,GAAAgB,QAAA,CAAApB,IAAA,CAAA2B,KAAA;IACA;IACAC,aAAAC,IAAA;MACA,IAAAA,IAAA,CAAAC,YAAA;QACA,KAAAC,OAAA,CAAAC,IAAA,wBAAAH,IAAA,CAAAZ,EAAA;MACA;QACA,KAAAc,OAAA,CAAAC,IAAA,YAAAH,IAAA,CAAAZ,EAAA;MACA;IACA;IACA,MAAAgB,cAAAC,QAAA;MACA,MAAAC,GAAA,cAAAC,KAAA,CAAAC,MAAA,CAAAC,IAAA,CACA,gBACA,oCACA,wBACA;MACA,IAAAH,GAAA;QACA,MAAAf,QAAA,QAAAC,IAAA,CAAAkB,OAAA;UACAhB,QAAA,OAAAC,UAAA,CAAAC,MAAA;UACAR,EAAA,EAAAiB,QAAA;UACAlC,IAAA;YACAwC,mBAAA,EAAAL;UACA;QACA;QACAf,QAAA,CACAqB,IAAA,YAAAhC,UAAA,IACAiC,KAAA,CAAAC,GAAA;UACA,KAAAC,MAAA,CAAAN,IAAA;YACAO,OAAA,EAAAF,GAAA;YACAG,IAAA;UACA;QACA;MACA;IACA;IACAC,gBAAAC,eAAA;MACA,MAAA5B,QAAA,QAAAC,IAAA,CAAA4B,MAAA;QACA1B,QAAA,OAAAC,UAAA,CAAA0B,gBAAA;QACAlD,IAAA;UACAmD,gBAAA,EAAAH;QACA;MACA;MACA5B,QAAA,CACAqB,IAAA;QACA,KAAAG,MAAA,CAAAN,IAAA;UACAO,OAAA;UACAC,IAAA;QACA;MACA,GACAJ,KAAA,CAAAU,KAAA;QACA,KAAAC,MAAA,QAAAC,WAAA,CAAAF,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}