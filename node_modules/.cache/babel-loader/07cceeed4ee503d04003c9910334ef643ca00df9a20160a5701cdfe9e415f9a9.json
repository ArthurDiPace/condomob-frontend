{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport decode from 'jwt-decode';\nimport router from '@/router';\nimport axios from 'axios';\nimport request from '@/services/config';\nconst http = axios.create({\n  baseURL: process.env.VUE_APP_API_URL\n});\nexport const handleLogin = data => {\n  return http.post('api/token/', data);\n};\nexport const setToken = async response => {\n  try {\n    localStorage.setItem('semob@accessToken', response.data.access);\n    localStorage.setItem('semob@refreshToken', response.data.refresh);\n    const userInfoResponse = await request.get('/api/user-info/');\n    const userInfo = userInfoResponse.data;\n    localStorage.setItem('semob@user', JSON.stringify(userInfo));\n    router.push('/');\n  } catch (error) {\n    console.error('Error setting token:', error);\n  }\n};\nexport const renewUser = async () => {\n  try {\n    const userInfoResponse = await request.get('/api/user-info/');\n    const userInfo = userInfoResponse.data;\n    localStorage.setItem('semob@user', JSON.stringify(userInfo));\n    window.location.reload();\n  } catch (error) {\n    console.error('Error setting user:', error);\n  }\n};\nexport const isValidToken = token => {\n  if (!token) {\n    return false;\n  }\n  const decoded = decode(token);\n  const currentTime = Date.now() / 1000;\n  return decoded.exp > currentTime;\n};\nexport const refreshToken = async () => {\n  http.post('api/token/refresh/', {\n    refresh: localStorage.getItem('semob@refreshToken')\n  }).then(res => {\n    localStorage.setItem('semob@accessToken', res.data.access);\n    localStorage.setItem('semob@user', JSON.stringify(decode(res.data.access)));\n  }).catch(() => {\n    clearToken();\n  });\n};\nexport const clearToken = () => {\n  localStorage.removeItem('semob@accessToken');\n  localStorage.removeItem('semob@refreshToken');\n  localStorage.removeItem('semob@user');\n};","map":{"version":3,"names":["decode","router","axios","request","http","create","baseURL","process","env","VUE_APP_API_URL","handleLogin","data","post","setToken","response","localStorage","setItem","access","refresh","userInfoResponse","get","userInfo","JSON","stringify","push","error","console","renewUser","window","location","reload","isValidToken","token","decoded","currentTime","Date","now","exp","refreshToken","getItem","then","res","catch","clearToken","removeItem"],"sources":["/home/arthur/semob/transporte/transporte-frontend/src/services/auth.service.js"],"sourcesContent":["import decode from 'jwt-decode'\nimport router from '@/router'\nimport axios from 'axios'\nimport request from '@/services/config'\n\nconst http = axios.create({\n  baseURL: process.env.VUE_APP_API_URL\n})\n\nexport const handleLogin = data => {\n  return http.post('api/token/', data)\n}\n\nexport const setToken = async (response) => {\n  try {\n    localStorage.setItem('semob@accessToken', response.data.access)\n    localStorage.setItem('semob@refreshToken', response.data.refresh)\n    const userInfoResponse = await request.get('/api/user-info/')\n    const userInfo = userInfoResponse.data\n    localStorage.setItem('semob@user', JSON.stringify(userInfo))\n    router.push('/')\n  } catch (error) {\n    console.error('Error setting token:', error)\n  }\n}\n\nexport const renewUser = async () => {\n  try {\n    const userInfoResponse = await request.get('/api/user-info/')\n    const userInfo = userInfoResponse.data\n    localStorage.setItem('semob@user', JSON.stringify(userInfo))\n    window.location.reload()\n  } catch (error) {\n    console.error('Error setting user:', error)\n  }\n}\n\nexport const isValidToken = token => {\n  if (!token) {\n    return false\n  }\n\n  const decoded = decode(token)\n  const currentTime = Date.now() / 1000\n  return decoded.exp > currentTime\n}\n\nexport const refreshToken = async () => {\n  http\n    .post('api/token/refresh/', {refresh: localStorage.getItem('semob@refreshToken')})\n    .then(res => {\n      localStorage.setItem('semob@accessToken', res.data.access)\n      localStorage.setItem('semob@user', JSON.stringify(decode(res.data.access)))\n    })\n    .catch(() => {\n      clearToken()\n    })\n}\n\nexport const clearToken = () => {\n  localStorage.removeItem('semob@accessToken')\n  localStorage.removeItem('semob@refreshToken')\n  localStorage.removeItem('semob@user')\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}